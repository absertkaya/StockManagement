@inherits ProductManageListBase

@page "/beheer/productlijst/{id:int}"
@using Blazored.Typeahead
@using StockManagement.Domain
<a href="/beheer" class="btn btn-outline-info"><i class="oi oi-arrow-thick-left"></i></a>
<h3 class="d-inline">Beheer @_category.CategoryName</h3>
<div class="form-group">
    <BlazoredTypeahead SearchMethod="SearchProduct" @bind-Value="_selectedProduct">
        <SelectedTemplate>@context.Description</SelectedTemplate>
        <ResultTemplate>@context.Description</ResultTemplate>
    </BlazoredTypeahead>
    <button class="btn btn-primary float-right" @onclick="NavigateToProductDetail">Zoek</button>
</div>

<div>
    <a href="/productscanner/categorie/@(Id)" class="btn btn-success"><i class="oi oi-plus"></i>Product</a>
</div>

<div>
    @if (_deleteFailProduct)
    {
        <p class="text-danger">Product kon niet worden verwijderd</p>
    }
    @if (_hasItems)
    {
        <p class="text-danger">Product heeft items, kon niet verwijderd worden.</p>
    }

<div class="table-responsive">
    <table class="table table-sm">
        <thead class="thead-dark">
            <tr>
                <th scope="col">Id</th>
                <th scope="col">Omschrijving</th>
                <th scope="col">P/N</th>
                <th scope="col">#</th>
                <th scope="col"></th>
            </tr>
        </thead>

        @if (_category != null && _category.Products != null)
        {
            @foreach (Product prod in _category.Products)
            {
                <tr>
                    <td>@prod.Id</td>
                    <td>@prod.Description</td>
                    <td>@prod.ProductNumber</td>
                    <td>@prod.AmountInStock</td>
                    <td>
                        <div class="btn-group btn-groep-sm">
                            <a href="/beheer/itemlijst/@(prod.Id)" class="btn btn-sm btn-primary"><i class="oi oi-magnifying-glass"></i></a>
                            <a href="/productform/id/@(prod.Id)" class="btn btn-sm btn-secondary"><i class="oi oi-pencil"></i></a>
                            @if (prod.Items.Count == 0)
                            {
                                <button @onclick="@(() => DeleteProduct(@prod.Id))" class="btn btn-sm btn-danger"><i class="oi oi-trash"></i></button>
                            }
                            else
                            {
                                <button class="btn btn-sm btn-danger" disabled><i class="oi oi-trash"></i></button>
                            }

                        </div>
                    </td>
                </tr>
            }
        }

    </table>
</div>

</div>

@code {

}
